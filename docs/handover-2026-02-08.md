# CivicStat — Session Handover

**Date:** 8 February 2026
**Sessions covered:** 7–8 Feb (beloften page build + polish)
**Repo:** `/Users/koenbekkering/Documents/New project`
**Live frontend:** https://civicstat-web.vercel.app
**Live API:** https://civicstat-api.fly.dev

---

## What Was Done (7–8 Feb Sessions)

### 1. Beloften Page Built & Deployed
- Created `/beloften` route in `civicstat-web/` with full promise-tracking UI
- 30 promises displayed (15 VVD + 15 GL-PvdA, TK2023 election cycle)
- Party & theme dropdown filters (server-side via search params)
- Each promise card shows: party badge, theme, specificity, expected vote direction, promise code, summary, original program text quote, and source reference
- Related motions listed per promise with vote bars and TK document numbers
- Pagination support (25 per page)
- "Beloften" added to main navigation (desktop + mobile)

### 2. Polish Pass (commit `e427455`)
- Fixed English labels → Dutch: "DIRECTIONAL" → "Directioneel", "CONCRETE" → "Concreet"
- Added "Verwacht: voor/tegen" badges for expected vote direction
- "geen stemming" shown in italic instead of empty dash for motions without votes
- Monospace font on promise codes and TK document numbers
- Italic program titles in source lines
- Added missing themes to filter dropdown: Buitenland, Landbouw, Sociaal
- Motion summary stats per promise (✓ N aangenomen × N verworpen N zonder stemming)
- Expandable motion lists — shows 3 initially, "+ N meer tonen" button to expand (client component `MotionMatchList.tsx`)
- Hover states on motion rows
- Methodology note at bottom of page

### 3. API `/promises` Endpoint (done in earlier session)
- Full endpoint at `GET /promises` with query params: `party`, `theme`, `limit`, `offset`
- Returns promises with nested program, party, and motionMatches data
- Motion matches include full motion data with vote breakdowns

---

## Current Architecture Note ⚠️

There are **two frontend directories** in the monorepo:

| Directory | Status | Deployed? |
|-----------|--------|-----------|
| `civicstat-web/` | Active — has beloften page, latest polish | ✅ Vercel (civicstat-web.vercel.app) |
| `apps/web/` | Older monorepo frontend — more pages but no beloften | ❌ Not currently deployed |

The Feb 7 handover stated `apps/web/` was canonical after consolidation, but the beloften sessions (7–8 Feb) built everything in `civicstat-web/`. **`civicstat-web/` is what's live.** A future task is to decide which to keep and consolidate fully.

---

## Current Data State

| Entity | Count | Notes |
|--------|-------|-------|
| Promises | 30 | 15 VVD + 15 GL-PvdA (TK2023) |
| Promise-motion matches | ~70+ | Keyword-overlap-v1 algorithm |
| Motions | 12,485 | All since TK2023 elections |
| Votes | 12,444 | 84.5% linked to motions |
| Programs | 30 | TK2023 (15) + TK2025 (15) |

---

## To-Do List

### High Priority
- [ ] **Resolve frontend duplication** — decide between `civicstat-web/` and `apps/web/`, consolidate into one
- [ ] **Fix civicstat.nl domain** — currently pointing to older/different project, needs DNS update to point to Vercel deployment
- [ ] **Expand promise extraction** — add more parties (PVV, NSC, D66, CDA, SP, PvdD, BBB, etc.) for TK2023 cycle
- [ ] **Build individual promise detail pages** (`/beloften/[id]`) — show full motion list, vote analysis, consistency score

### Medium Priority
- [ ] **Add loading states** to beloften page (skeleton cards while fetching)
- [ ] **Empty state improvements** — better messaging when no matches found for a promise
- [ ] **Search functionality** — global search across motions, promises, members
- [ ] **Motion-to-promise cross-links** — from motion detail pages, show which promises they relate to
- [ ] **Party scorecards** — aggregate promise consistency per party (Mandate Consistency Score)

### Lower Priority
- [ ] **TK2025 election promises** — extract promises from the newer election programs
- [ ] **Prediction system** — forecast vote outcomes based on election promises (see `promise-prediction-pipeline.md`)
- [ ] **Individual MP profile pages** — voting behavior, sponsored motions, party loyalty
- [ ] **Methodology/transparency page** — document how matching works, scoring, limitations
- [ ] **Contextual feedback widgets** — let users flag incorrect matches or missing promises
- [ ] **Mobile responsive polish** — test and fix any layout issues on small screens
- [ ] **Coalition Alignment Index** — measure how closely coalition parties vote together

### Technical Debt
- [ ] **Vote bar component** — some motions show no bar when vote data exists but isn't in expected format
- [ ] **Match type labels** — currently all show "impliciet" (IMPLICIT_MATCH) — need to support DIRECT_MATCH when implemented
- [ ] **API pagination** — verify promise endpoint handles large result sets efficiently
- [ ] **Error boundaries** — add proper error handling for individual card render failures

---

## Key Files

```
civicstat-web/
├── app/beloften/
│   ├── page.tsx              # Main promises listing (server component)
│   ├── BeloftenFilters.tsx   # Party & theme dropdown filters (client component)
│   └── MotionMatchList.tsx   # Expandable motion list (client component)
├── lib/
│   ├── api.ts                # getPromises() and other API functions
│   └── types.ts              # PromiseListItem and related types
└── components/
    ├── PartyBadge.tsx
    └── VoteBar.tsx

packages/etl/src/
├── promises/                 # Promise extraction scripts
└── match-promises.ts         # Motion-to-promise matching algorithm
```

---

## How to Continue

1. **Start a new session** by reading this handover + the main handover (`handover-2026-02-07-final.md`)
2. **Check the live site** at https://civicstat-web.vercel.app/beloften
3. **Pick a to-do item** from the list above
4. **For promise extraction**: see `promise-prediction-pipeline.md` in project knowledge for the methodology
5. **For frontend work**: the design system uses Instrument Serif + Plus Jakarta Sans, moss/mist/ink palette — see `globals.css` in `civicstat-web/`
